{"ts":1363821598741,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"#!/usr/bin/perl \n\n# ------------------------------------------------------------------ #\n# includes\n\nuse strict;\n\n# ------------------------------------------------------------------ #\n# initialise\nmy $ini_path = \"d:\\\\emu\\\\maws\\\\dat\\\\nplayers\\\\nplayers101.ini\";\n\n# ------------------------------------------------------------------ #\n# globals\nmy @ini_content;\nmy $ini_name = \"\";\nmy %ini_data;\n\n# ------------------------------------------------------------------ #\n# main\n\n\n# read source ini file\nif ( open(INIDATA,\"<$ini_path\" ) ) {\n  @ini_content = <INIDATA>;\n  close(INIDATA);\n\n  # read each line and parse\n  foreach my $curr_line (@ini_content) {\n    # check for just whitespace\n    if ( $curr_line =~ m/^\\s+$/i ) {\n      # print \"White space only: \".$line_num.\"\\n\";\n    # comment line\n    } elsif ($curr_line =~ m/^(\\;|\\:).*$/i ) {\n      # ignore comment line\n\n    # new folder type (new file?)\n    } elsif ($curr_line =~ m/\\[(.*)\\]/i ) {\n      if ( $ini_name ) {\n        # multiple folders (like catver.ini)\n        &write_ini32_file( $ini_name.\"_32\\.ini\", \\%ini_data );\n      }\n      $ini_name = $1;\n      %ini_data = ();\n      print \"ini \".$ini_name.\"\\n\";\n        \n    # capture data\n    } elsif ($curr_line =~ m/^(\\S+)\\=(.*?)\\s*$/i ) {\n      if ( $ini_data{$2} ) {\n        $ini_data{$2} .= \"\\r\\n\".$1;\n      } else {\n        $ini_data{$2} = $1;\n      }\n    }\n  }\n  &write_ini32_file( $ini_name.\"_32\\.ini\", \\%ini_data );\n  @ini_content = ();\n\n} else {\n  print \"Can\\'t open $ini_path for reading\\n\";\n}\n\nexit;\n\nsub write_ini32_file {\n  my ( $ini32_path, $ini_hash_ref, @p ) = @_;\n  my ( %ini_hash, $folder );\n  %ini_hash = %$ini_hash_ref;\n  if ( open(INI32DATA,\">$ini32_path\" ) ) {\n    print INI32DATA \"[FOLDER_SETTINGS]\\r\\n\";\n    print INI32DATA \"RootFolderIcon = cust1.ico\\r\\n\";\n    print INI32DATA \"SubFolderIcon = cust2.ico\\r\\n\\r\\n\";\n    print INI32DATA \"[ROOT_FOLDER]\\r\\n\\r\\n\";\n    \n    foreach $folder (sort keys %ini_hash) {\n      print INI32DATA \"[\".$folder.\"]\\r\\n\".$ini_hash{$folder}.\"\\r\\n\\r\\n\";\n    }\n  } else {\n    print \"Can\\'t open $ini32_path for writing\\n\";\n  }\n}\n\n__END__\n\n"]],"start1":0,"start2":0,"length1":0,"length2":2095}]],"length":2095}
